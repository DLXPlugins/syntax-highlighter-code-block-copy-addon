{"version":3,"file":"copy-frontend.js","mappings":"yBAAA,IAAI,EAA+BA,OAAW,GAAQ,KCMtDC,SAASC,iBAAkB,oBAAoB,KAG9C,MAAMC,EAAiBF,SAASG,iBAAkB,sDAC7C,OAASD,GAMPE,UAAUC,WAKjBH,EAAeI,SAAWC,IAEzB,MAAMC,EAAWD,EAAcE,uBACzBC,EAAgBH,EAAcE,uBAAuBE,WAAW,GAChEC,EAAkBJ,EAASK,UAGjC,IAAOD,EAAgBE,SAAU,iBAChC,OAID,MAAMC,EAAef,SAASgB,cAAe,OAC7CD,EAAaF,UAAUI,OAAQL,GAG/B,MAAMM,EAAaV,EAASW,aAAc,MACrCD,GACJH,EAAaK,aAAc,KAAMF,GAIlC,MAAMG,EAAerB,SAASgB,cAAe,OAG7CK,EAAaC,MAAMC,QAAU,IAC7BF,EAAaC,MAAME,OAAS,IAC5BH,EAAaC,MAAMG,SAAW,WAG9Bf,EAAcgB,gBAAiB,MAC/BhB,EAAciB,UAAWf,GAGzBS,EAAaO,YAAalB,GAG1BW,EAAaO,YAAarB,GAG1BQ,EAAaa,YAAaP,GAG1Bb,EAASqB,WAAWC,aAAcf,EAAcP,GAChDA,EAASmB,SAGT,MAAMI,EAAaxB,EAAcyB,cAAe,UAC3C,OAASD,GAKdA,EAAW9B,iBAAkB,SAAS,KAErC,MAMMgC,EANWF,EAAWG,QAAS,kBAGVF,cAAe,QAGVG,UAEhC,IACC,MAAMC,EAAW,IAAIC,KAAM,CAAEJ,GAAiB,CAAEK,KAAM,eAChDC,EAAO,CAAE,IAAIC,cAAe,CAAE,CAAEJ,EAASE,MAAQF,KACvDhC,UAAUC,UAAUoC,MAAOF,GAG3BR,EAAWC,cAAe,OAAQZ,aAAc,aAAc,sBAG9DsB,YAAY,KACXX,EAAWC,cAAe,OAAQZ,aAAc,aAAc,eAAgB,GAC5E,OAGHuB,EAAAA,EAAAA,OAAOC,wCAAwCC,YAEhD,CAAE,MAAQC,GACT,IAEC,GACD,G","sources":["webpack://syntax-highlighting-code-block-copy-addon/external window [\"wp\",\"a11y\"]","webpack://syntax-highlighting-code-block-copy-addon/./src/copy.js"],"sourcesContent":["var __WEBPACK_NAMESPACE_OBJECT__ = window[\"wp\"][\"a11y\"];","/**\n * Copy to clipboard functionality for the code block.\n */\nimport { speak } from '@wordpress/a11y';\n\n// Set up event on document load.\ndocument.addEventListener( 'DOMContentLoaded', () => {\n\n\t// Let's grab all copy containers.\n\tconst copyContainers = document.querySelectorAll( '.dlx-syntax-highlighting-code-block-copy-container' );\n\tif ( null === copyContainers ) {\n\t\treturn;\n\t}\n\n\t// Do not do anything if copying to clipboard is not supported.\n\t// If firefox, navigator.clipboard.write() will throw an error.\n\tif ( ! navigator.clipboard ) {\n\t\treturn;\n\t}\n\n\t// Loop through each copy container, grab its sibling (should be a pre with class .wp-block-code), copy classes, add container element, and place copy container inside this new container element.\n\tcopyContainers.forEach( ( copyContainer ) => {\n\t\t// Grab previous sibling, which should be a pre with class .wp-block-code.\n\t\tconst preBlock = copyContainer.previousElementSibling;\n\t\tconst preBlockClone = copyContainer.previousElementSibling.cloneNode( true );\n\t\tconst preBlockClasses = preBlock.classList;\n\n\t\t// Check that it is a pre with class .wp-block-code.\n\t\tif ( ! preBlockClasses.contains( 'wp-block-code' ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Let's create a parent around everything, copying pre attributes and moving them to the parent.\n\t\tconst newContainer = document.createElement( 'div' );\n\t\tnewContainer.classList.add( ...preBlockClasses );\n\n\t\t// Add pre ID to new container.\n\t\tconst preBlockId = preBlock.getAttribute( 'id' );\n\t\tif ( preBlockId ) {\n\t\t\tnewContainer.setAttribute( 'id', preBlockId );\n\t\t}\n\n\t\t// Let's create a container to go around the pre tag.\n\t\tconst preContainer = document.createElement( 'div' );\n\n\t\t// Force no padding/margin/spacing on container.\n\t\tpreContainer.style.padding = '0';\n\t\tpreContainer.style.margin = '0';\n\t\tpreContainer.style.position = 'relative';\n\n\t\t// Strip preBlock of its classes and ID.\n\t\tpreBlockClone.removeAttribute( 'id' );\n\t\tpreBlockClone.remove( ...preBlockClasses );\n\n\t\t// Move pre block inside of container.\n\t\tpreContainer.appendChild( preBlockClone );\n\n\t\t// Move copy container inside pre-container.\n\t\tpreContainer.appendChild( copyContainer );\n\n\t\t// Add pre-container to new container.\n\t\tnewContainer.appendChild( preContainer );\n\n\t\t// Now add new container above pre block and remove old pre block.\n\t\tpreBlock.parentNode.insertBefore( newContainer, preBlock );\n\t\tpreBlock.remove();\n\n\t\t// Now let's find the copy button and add a click event to it.\n\t\tconst copyButton = copyContainer.querySelector( 'button' );\n\t\tif ( null === copyButton ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Add click event.\n\t\tcopyButton.addEventListener( 'click', () => {\n\t\t\t// Grab the pre block.\n\t\t\tconst preBlock = copyButton.closest( '.wp-block-code' );\n\n\t\t\t// Grab the code block.\n\t\t\tconst codeBlock = preBlock.querySelector( 'code' );\n\n\t\t\t// Grab the code block's text.\n\t\t\tconst codeBlockText = codeBlock.innerText;\n\n\t\t\ttry {\n\t\t\t\tconst copyBlob = new Blob( [ codeBlockText ], { type: 'text/plain' } );\n\t\t\t\tconst data = [ new ClipboardItem( { [ copyBlob.type ]: copyBlob } ) ];\n\t\t\t\tnavigator.clipboard.write( data );\n\n\t\t\t\t// Change icon to checkmark.\n\t\t\t\tcopyButton.querySelector( 'use' ).setAttribute( 'xlink:href', '#lucide-copy-check' );\n\n\t\t\t\t// Change icon back to copy.\n\t\t\t\tsetTimeout( () => {\n\t\t\t\t\tcopyButton.querySelector( 'use' ).setAttribute( 'xlink:href', '#lucide-copy' );\n\t\t\t\t}, 1500 );\n\n\t\t\t\t// Let the user know the code block has been copied.\n\t\t\t\tspeak( dlxSyntaxHighlightingCodeBlockCopyAddon.copiedLabel );\n\t\t\t\t\n\t\t\t} catch ( e ) {\n\t\t\t\t// Copying is not supported on Mozilla (firefox).\n\t\t\t}\t\t\t\n\t\t} );\n\t} );\n} );"],"names":["window","document","addEventListener","copyContainers","querySelectorAll","navigator","clipboard","forEach","copyContainer","preBlock","previousElementSibling","preBlockClone","cloneNode","preBlockClasses","classList","contains","newContainer","createElement","add","preBlockId","getAttribute","setAttribute","preContainer","style","padding","margin","position","removeAttribute","remove","appendChild","parentNode","insertBefore","copyButton","querySelector","codeBlockText","closest","innerText","copyBlob","Blob","type","data","ClipboardItem","write","setTimeout","speak","dlxSyntaxHighlightingCodeBlockCopyAddon","copiedLabel","e"],"sourceRoot":""}